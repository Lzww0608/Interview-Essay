# 49.docker退出

当Docker容器退出后，使用`docker ps`命令查看不到它，因为`docker ps`默认只列出正在运行的容器。如果容器已经退出，可以使用`docker ps -a`命令查看所有容器，包括已停止的容器。至于数据是否丢失，这取决于容器的数据存储方式。如果容器使用了**数据卷（volumes）**或**绑定挂载（bind mounts）**，那么数据不会丢失。如果没有使用这些存储方式，容器中的数据通常会丢失。

### 详细讲解与拓展

1. `docker ps`与`docker ps -a`的区别：

   - `docker ps`命令仅列出正在运行的容器。当容器停止或退出后，它就不会出现在`docker ps`的输出中。
   - 如果你希望查看所有容器（包括已停止的容器），可以使用`docker ps -a`命令，这样就能看到包括退出的容器。

2. 数据丢失的原因：

   - **容器的文件系统是临时的**：Docker容器使用的是临时文件系统（例如`aufs`、`overlay2`等），它的生命周期与容器绑定在一起。当容器退出或删除时，容器内的文件和数据通常会丢失，除非使用了外部存储机制。

3. 使用数据卷（Volumes）：

   - Docker提供了**数据卷（volumes）**来持久化容器的数据。数据卷是托管在Docker宿主机文件系统中的独立区域，容器停止或删除时，数据卷中的数据依然保留。因此，如果你在容器中使用了数据卷，那么即使容器退出或删除，数据也不会丢失。

   - 创建并使用数据卷的命令：

     ```bash
     docker run -v my_volume:/path/in/container my_image、
     ```

   - `my_volume`是你创建的数据卷，`/path/in/container`是容器内的数据路径。

4. 使用绑定挂载（Bind Mounts）：

   - 绑定挂载是一种将宿主机的指定目录挂载到容器的机制。通过这种方式，容器的数据直接存储在宿主机的指定目录中，容器退出或删除时，宿主机上的数据不会丢失。

   - 使用绑定挂载的命令：

     ```bash
     docker run -v /host/path:/container/path my_image
     ```

   - 这里，`/host/path`是宿主机上的目录，`/container/path`是容器内的路径。

5. 没有使用数据存储机制的情况下：

   - 如果容器没有使用数据卷或绑定挂载，容器退出时所有写入容器内的临时数据都会丢失。当容器被删除时，数据也会被清除。
   - 这种情况下，如果你希望保留数据，可以考虑将数据写入外部存储（如数据库、对象存储等）或使用Docker提供的持久化存储方式。

6. 查看退出的容器：

   - 如果容器已经退出，但没有被删除，可以使用以下命令查看：

     ```bash
     docker ps -a
     ```

   - 如果你希望恢复已退出容器中的数据，可以考虑重新启动容器：

     ```bash
     docker start <container_id>
     ```

**总结**：退出后的Docker容器默认不会显示在`docker ps`中，但你可以使用`docker ps -a`查看已停止的容器。如果容器没有使用数据卷或绑定挂载存储，容器的数据可能会丢失。为了避免数据丢失，建议使用数据卷或绑定挂载来持久化数据。