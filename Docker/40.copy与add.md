# 40.copy与add

`COPY`和`ADD`命令都用于将文件从宿主机复制到Docker镜像中，但它们有以下几个主要区别：

1. 功能区别：
   - `COPY`：只能复制本地文件或目录到镜像中。
   - `ADD`：除了复制文件或目录外，还支持从URL下载文件并解压本地`.tar`文件。
2. 用途区别：
   - `COPY`：推荐用于单纯的文件复制场景。
   - `ADD`：适用于需要下载远程文件或者自动解压`.tar`文件的场景。

### 详细讲解与拓展

1. `COPY`命令：

   - `COPY`指令用于将宿主机的文件或目录复制到镜像中。它不会进行任何额外的处理，仅仅执行复制操作。它有两个参数：源路径和目标路径。

   - 示例：

     ```dockerfile
     COPY ./localfile.txt /usr/src/app/
     ```

     这条命令会将宿主机上的`localfile.txt`文件复制到镜像中的`/usr/src/app/`目录。

- 推荐使用场景：
  - 当你只需要将本地的文件或目录复制到镜像时，使用`COPY`更简洁、安全，且其行为更直观。

1. `ADD`命令：

   - ```
     ADD
     ```

     指令不仅支持复制本地文件和目录，还支持以下额外功能：

     - 从URL下载文件。
     - 自动解压`.tar`格式的压缩文件（包括`.tar.gz`、`.tar.bz2`、`.tar.xz`等格式）。

   - 示例：

     ```dockerfile
     ADD https://example.com/file.tar.gz /usr/src/app/
     ```

     这条命令会从`https://example.com/file.tar.gz`下载文件并将其解压到容器的`/usr/src/app/`目录。

- 推荐使用场景：
  - 当你需要从外部URL下载文件，或者需要将`.tar`文件解压到容器内时，使用`ADD`命令。

1. 区别总结：
   - **文件复制**：`COPY`仅支持复制本地文件，而`ADD`支持更多功能，如从URL下载文件和解压`.tar`文件。
   - **性能考虑**：由于`ADD`具有更多的功能，可能会带来不必要的复杂性（如自动解压）。如果不需要额外功能，建议优先使用`COPY`，以简化构建过程并提升可维护性。

**总结**：`COPY`和`ADD`都用于将文件从宿主机复制到镜像，但`COPY`功能更简单，仅用于复制文件，而`ADD`支持从URL下载文件和自动解压`.tar`文件。通常推荐使用`COPY`，只有在需要下载远程文件或解压文件时才使用`ADD`。