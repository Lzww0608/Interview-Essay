# Q15.RDB持久化

RDB（Redis Database）持久化是Redis提供的一种数据持久化方法，它可以将内存中的数据以二进制的形式写入磁盘，以保证数据在重启或者异常情况下的持久性。

RDB持久化工作原理：

1. 快照生成：当触发RDB持久化时，Redis会将当前内存中的数据通过**fork()系统调用创建一个子进程**，由子进程负责在后台进行快照生成。
2. 数据存储：子进程会将内存中的数据按照指定的数据结构和格式保存到一个临时文件中。
3. 替换原文件：当持久化过程结束后，子进程会将临时文件替换原有的RDB文件。
4. 恢复数据：在Redis重启的时候，会通过加载RDB文件将数据重新读入内存中。

RDB持久化的优点：

1. 性能高：由于是在后台进行持久化操作，不会阻塞主线程，所以对Redis的性能影响较小。
2. 容灾性强：通过RDB文件，可以将数据备份到磁盘中，保证数据在异常情况下的可恢复性。

RDB持久化的缺点：

1. **数据丢失**：由于RDB持久化是通过生成快照的方式进行的，如果Redis在最后一次持久化之后发生故障，会导致最后一次持久化之后的数据丢失。
2. **时效性**：RDB持久化是定期执行的，数据的持久化是在配置的时间间隔之后，因此在发生故障之前的数据可能会丢失。

需要注意的是，RDB持久化机制适合用于数据备份、数据迁移等场景，但对于实时性要求较高的应用（如消息队列），可能不适合使用RDB持久化。此时，可以考虑使用AOF（Append Only File）持久化机制。

