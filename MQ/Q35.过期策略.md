# Q35.过期策略

消息队列的消息过期策略，通常是指消息在队列中可以存活的时间。不同的消息队列系统可能有不同的实现和配置方法，但基本概念是一致的。以下是一些关键点：

1. **时间戳过期**：在消息队列中，每条消息通常会有一个时间戳，表明了它被创建或发送的时间。消息队列的配置可能允许设置一个“生存时间”（TTL, Time-To-Live），一旦超过这个时间，消息将被认为是过期的。
2. **队列或主题级别的过期**：某些系统允许在队列或主题级别设置过期时间，这意味着所有通过这个队列或主题的消息都将遵循相同的过期策略。
3. **消息级别的过期**：一些系统允许在发送消息时指定其TTL，这提供了更细粒度的控制，适用于需要单独管理每条消息生存周期的场景。
4. **过期消息的处理**：过期的消息可能会被自动删除，或者被发送到另一个“死信队列”（DLQ, Dead Letter Queue），在那里可以进一步处理，如记录、警告或者重试。

消息过期策略的作用：

- **资源管理**：自动清理过期消息可以帮助管理存储资源，防止消息队列过载。
- **保证时效性**：对于那些具有明确处理窗口或实时性要求的消息，过期策略可以保证只有最新的数据被处理。
- **避免消息积压**：在高吞吐的系统中，过期策略可以防止过时的消息积压，影响系统性能。
- **实现消息的延迟处理**：通过设置TTL，可以实现消息的延迟发送，即在将来的某个时间点才真正投入队列。

在实际应用中，正确配置消息过期策略对于保证消息队列的性能和可靠性至关重要。比如，在股票交易系统中，过期的交易指令不应当被执行，因此需要设定合适的TTL以避免执行过时的交易。